"use strict";
const decode = require("./platform/decode/decode.js"),
  node = require("./platform/crypto/node.js");
/**
 *
 *
 * @export
 * @param {HmacOptions} options
 * @return {boolean}
 */
function compareHmac({ algorithm = "sha256", data, digest, key }) {
  if (typeof key === "string") key = decode.utf8ToUint8Array(key);
  if (typeof data === "string") data = decode.utf8ToUint8Array(data);
  if (typeof digest === "string") digest = decode.hexToUint8Array(digest);
  const hash = node.hmac(algorithm, key, data);
  return node.timingSafeEqual(hash, digest);
}
const QIWI_JOINER = "|";
/**
 *
 *
 * @export
 * @param {string} key
 * @param {string} digest
 * @param {string[]} data
 * @return {boolean} boolean
 */
function compareQiwiHmac(key, digest, data) {
  return compareHmac({ key, digest, data: data.join(QIWI_JOINER) });
}
exports.compareHmac = compareHmac;
exports.compareQiwiHmac = compareQiwiHmac;
