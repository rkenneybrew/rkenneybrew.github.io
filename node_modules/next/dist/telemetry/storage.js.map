{"version":3,"sources":["../../src/telemetry/storage.ts"],"names":["Telemetry","TELEMETRY_KEY_ENABLED","TELEMETRY_KEY_NOTIFY_DATE","TELEMETRY_KEY_ID","TELEMETRY_KEY_SALT","getStorageDirectory","distDir","isLikelyEphemeral","ciEnvironment","isCI","isDockerFunction","path","join","undefined","constructor","notify","isDisabled","conf","get","set","Date","now","toString","console","log","chalk","magenta","bold","cyan","setEnabled","_enabled","enabled","oneWayHash","payload","hash","createHash","update","salt","digest","record","_events","deferred","prom","Promise","resolve","isFulfilled","isRejected","value","submitRecord","then","catch","reason","res","queue","delete","Array","isArray","_controller","add","flush","all","flushDetached","mode","dir","allEvents","forEach","item","abort","push","_","fs","writeFileSync","JSON","stringify","spawn","process","execPath","require","detached","NEXT_TELEMETRY_DEBUG","windowsHide","shell","stdio","events","length","eventName","error","context","anonymousId","projectId","sessionId","meta","getAnonymousMeta","postController","AbortController","_postPayload","map","fields","signal","NEXT_TELEMETRY_DISABLED","env","storageDirectory","Conf","projectName","cwd","randomBytes","rawProjectId","getRawProjectId","Set","val","generated","isEnabled"],"mappings":"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"}