{"version":3,"sources":["../../../../src/build/webpack/plugins/flight-manifest-plugin.ts"],"names":["ClientReferenceManifestPlugin","pluginState","getProxiedPluginState","serverModuleIds","edgeServerModuleIds","ASYNC_CLIENT_MODULES","PLUGIN_NAME","constructor","options","dev","appDir","Set","apply","compiler","hooks","compilation","tap","normalModuleFactory","dependencyFactories","set","webpack","dependencies","ModuleDependency","dependencyTemplates","NullDependency","Template","make","processAssets","name","stage","Compilation","PROCESS_ASSETS_STAGE_OPTIMIZE_HASH","assets","createAsset","context","manifest","ssrModuleMapping","edgeSSRModuleMapping","cssFiles","clientModules","clientRequestsSet","collectClientRequest","mod","resource","buildInfo","rsc","requests","forEach","r","add","traverseModules","chunkGroups","chunkGroup","recordModule","id","chunkCSS","isCSSModule","isCSSMod","layer","WEBPACK_LAYERS","appClient","type","_identifier","slice","lastIndexOf","moduleReferences","moduleIdMapping","edgeModuleIdMapping","ssrNamedModuleId","relative","resourceResolveData","path","startsWith","replace","exportName","getClientReferenceModuleKey","chunks","has","isClientComponentEntryModule","exportsInfo","moduleGraph","getExportsInfo","isAsyncModule","cjsExports","map","dep","base","names","filter","clientRefs","Boolean","flat","getAppPathRequiredChunks","requiredChunk","SYSTEM_ENTRYPOINTS","files","file","endsWith","nonNullable","requiredChunks","esmResource","test","sep","addClientReference","async","edgeExportName","addSSRIdMapping","moduleExportedKeys","exports","exportInfo","provided","key","chunk","chunkModules","chunkGraph","getChunkModulesIterable","f","modId","getModuleId","anyModule","modules","concatenatedMod","entryCSSFiles","addCSSFilesToEntry","entryName","concat","getFiles","length","getParents","parent","CLIENT_REFERENCE_MANIFEST","json","JSON","stringify","undefined","sources","RawSource"],"mappings":"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"}