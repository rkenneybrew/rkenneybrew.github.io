{"version":3,"sources":["../../src/server/server-route-utils.ts"],"names":["getRedirectStatus","modifyRouteRegex","getPathMatch","compileNonPath","prepareDestination","getRequestMeta","stringify","stringifyQs","format","formatUrl","normalizeRepeatedSlashes","getCustomRoute","params","rule","type","restrictedRedirectPaths","match","source","strict","removeUnnamedParams","regexModifier","internal","regex","undefined","name","fn","_req","_res","_params","_parsedUrl","finished","createHeaderRoute","headerRoute","matchesBasePath","matchesLocale","matchesLocaleAPIRoutes","matchesTrailingSlash","has","missing","res","hasParams","Object","keys","length","header","headers","key","value","toLowerCase","appendHeader","setHeader","stringifyQuery","req","query","initialQuery","initialQueryValues","values","encodeURIComponent","some","initialQueryVal","Array","isArray","includes","createRedirectRoute","redirectRoute","statusCode","parsedUrl","parsedDestination","appendParamsToQuery","destination","search","updatedDestination","startsWith","redirect","body","send"],"mappings":"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"}