'use strict';

module.exports = ({ passport, config }) => {
  const { NAME, SESSION } = config.JWT.APOLITICAL;

  return function handler(req, res) {
    // Passport JWT authentication (Apolitical)
    return new Promise((resolve) => {
      passport.authenticate(NAME, SESSION, (err, user) => {
        if (err) {
          return resolve();
        }
        return resolve(user);
      })(req, res);
    });
  };
};
